---
import { property } from "../data/property";

interface Props {
  transparent?: boolean;
}

const { transparent = false } = Astro.props;

const navLinks = [
  { href: "/", label: "Home" },
  { href: "/#gallery", label: "Gallery" },
  { href: "/#amenities", label: "Amenities" },
  { href: "/house-rules", label: "House Rules" },
];

const currentPath = Astro.url.pathname;
---

<header
  id="header"
  class:list={[
    "fixed top-0 left-0 right-0 z-50 transition-all duration-300",
    transparent ? "bg-transparent" : "bg-white/95 backdrop-blur-sm shadow-sm",
  ]}
  data-transparent={transparent}
>
  <nav class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="flex h-16 items-center justify-between md:h-20">
      <!-- Logo -->
      <a
        href="/"
        class:list={[
          "text-lg font-semibold tracking-tight transition-colors md:text-xl",
          transparent ? "text-white" : "text-neutral-900",
        ]}
      >
        {property.name}
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden items-center gap-8 md:flex">
        {
          navLinks.map((link) => (
            <a
              href={link.href}
              class:list={[
                "text-sm font-medium transition-colors hover:text-primary-600",
                transparent
                  ? "text-white/90 hover:text-white"
                  : "text-neutral-600",
                currentPath === link.href && !transparent && "text-primary-600",
              ]}
            >
              {link.label}
            </a>
          ))
        }
        <a
          href={property.links.airbnb}
          target="_blank"
          rel="noopener noreferrer"
          class="rounded-lg bg-primary-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:bg-primary-700 hover:shadow-md"
        >
          Book Now
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-button"
        type="button"
        class:list={[
          "inline-flex items-center justify-center rounded-lg p-2 md:hidden",
          transparent ? "text-white" : "text-neutral-700",
        ]}
        aria-expanded="false"
        aria-label="Toggle navigation menu"
      >
        <svg
          id="menu-icon-open"
          class="h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path>
        </svg>
        <svg
          id="menu-icon-close"
          class="hidden h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <!-- Mobile Menu -->
    <div
      id="mobile-menu"
      class="hidden overflow-hidden transition-all duration-300 md:hidden"
    >
      <div class="space-y-1 pb-4 pt-2">
        {
          navLinks.map((link) => (
            <a
              href={link.href}
              class:list={[
                "block rounded-lg px-3 py-2 text-base font-medium transition-colors",
                transparent
                  ? "text-white/90 hover:bg-white/10 hover:text-white"
                  : "text-neutral-700 hover:bg-neutral-100 hover:text-primary-600",
                currentPath === link.href &&
                  !transparent &&
                  "bg-primary-50 text-primary-600",
              ]}
            >
              {link.label}
            </a>
          ))
        }
        <a
          href={property.links.airbnb}
          target="_blank"
          rel="noopener noreferrer"
          class="mt-2 block rounded-lg bg-primary-600 px-3 py-2.5 text-center text-base font-semibold text-white transition-colors hover:bg-primary-700"
        >
          Book Now
        </a>
      </div>
    </div>
  </nav>
</header>

<script>
  const header = document.getElementById("header");
  const mobileMenuButton = document.getElementById("mobile-menu-button");
  const mobileMenu = document.getElementById("mobile-menu");
  const menuIconOpen = document.getElementById("menu-icon-open");
  const menuIconClose = document.getElementById("menu-icon-close");

  // Mobile menu toggle
  mobileMenuButton?.addEventListener("click", () => {
    const isExpanded =
      mobileMenuButton.getAttribute("aria-expanded") === "true";
    mobileMenuButton.setAttribute("aria-expanded", String(!isExpanded));
    mobileMenu?.classList.toggle("hidden");
    menuIconOpen?.classList.toggle("hidden");
    menuIconClose?.classList.toggle("hidden");
  });

  // Scroll-based header background (only for transparent headers)
  if (header?.dataset.transparent === "true") {
    const updateHeader = (): void => {
      if (window.scrollY > 50) {
        header.classList.remove("bg-transparent");
        header.classList.add("bg-white/95", "backdrop-blur-sm", "shadow-sm");
        header.querySelectorAll("a").forEach((link) => {
          if (!link.classList.contains("bg-primary-600")) {
            link.classList.remove("text-white", "text-white/90");
            link.classList.add("text-neutral-600", "text-neutral-900");
          }
        });
        mobileMenuButton?.classList.remove("text-white");
        mobileMenuButton?.classList.add("text-neutral-700");
      } else {
        header.classList.add("bg-transparent");
        header.classList.remove("bg-white/95", "backdrop-blur-sm", "shadow-sm");
        header.querySelectorAll("a").forEach((link) => {
          if (!link.classList.contains("bg-primary-600")) {
            link.classList.add("text-white", "text-white/90");
            link.classList.remove("text-neutral-600", "text-neutral-900");
          }
        });
        mobileMenuButton?.classList.add("text-white");
        mobileMenuButton?.classList.remove("text-neutral-700");
      }
    };

    window.addEventListener("scroll", updateHeader);
    updateHeader();
  }
</script>
